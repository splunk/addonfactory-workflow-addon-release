name: Virustotal security check

description: Performs a VirusTotal scan on the artifacts generated by a "build" job

inputs:
  VT_API_KEY:
    required: true

runs:
  using: composite
  steps:
    - name: Download artifact
      uses: actions/download-artifact@v3
      with:
        name: package-splunkbase
        path: build/package/

    - name: VirusTotal Scan
      uses: crazy-max/ghaction-virustotal@v3
      with:
        vt_api_key: ${{ inputs.VT_API_KEY }}
        files: |
          build/package/*